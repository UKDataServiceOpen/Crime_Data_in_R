---
title: "Topic 1: Exploring Crime Data"
author: "Nadia Kennar"
date: "1st December 2021"
output: html_notebook
toc: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# for data reading/manipulation 
library(dplyr)
library(tidyr)
library(readr)
library(tibble)
library(janitor)
# for spatial data and gis
library(sf)
library(ggmap)
library(ggplot2)
library(ggspatial)
library(ggspatial)
library(spdep)
library(leaflet) 
library(RColorBrewer)
library(tmap)

```



  
## Downloading the crime data 

 *https://data.police.uk/*. 

Read in just the January 2019 month of data


```{r crime data}
#unzip(file.choose())
crime01_19 <- read_csv("Data/2020-08/2020-08-surrey-street.csv") %>% 
  janitor::clean_names() 

#explore variables
glimpse(crime01_19)

```




## Briefly explore the data using ggmap and ggplot (Ariel Map)


```{r using ggmap}
## Ariel Map of Surrey
qmplot(longitude, latitude, data = crime01_19, colour = crime_type, size = I(3), darken = .3)



## Lets just say you were interested in a specific area (in this example we will use Crawley 002B)

## Ariel Map of Crawley 002B
geocode("Crawley 002B")
Crawley <- c(long = -0.152210, lat = 51.15813)
map <- get_map(Crawley, zoom = 13, scale = 1)
ggmap(map)

ggmap(map) +
  geom_point(aes(longitude, latitude), data = crime01_19) 


## Colour the Crime Type

ggmap(map) +
  geom_point(aes(longitude, latitude, colour = crime_type), data = crime01_19) 

ggmap(map) +
  geom_point(aes(longitude, latitude, size = crime_type, colour = crime_type), data = crime01_19) 



```





## Simple Features and Projection methods


```{r simple features }
st_crs(crime01_19)   # to check the crs

sf <- st_as_sf(crime01_19,                                
                      coords = c("longitude", "latitude"),
                      crs = 4326, 
                      na.fail = FALSE)
st_crs(sf)


```





## Mapping point data 


```{r}
#### Plot the point data
ggplot() + 
  geom_sf(data = sf)


#### Colour the different crime type
ggplot() + 
  geom_sf(data = sf, aes(fill = crime_type, col = crime_type))


#### Reference map / base map  
ggplot() + 
  annotation_map_tile() +
  geom_sf(data = sf)



#### Sub-setting for just ASB 
asb <- subset(sf, crime_type == "Anti-social behaviour") %>% 
  select(-c(1, 9, 10))

ggplot() +
  annotation_map_tile() +
  geom_sf(data = asb)



```







## Activity 1

How does this compare to the crime_type 'drugs'?

Steps; 
1. Subset the data for the those crime types recorded as 'drugs', 
2. create this into a new object like we did for ASB and name it 'drugs' 
3. Using ggplot plot the point data over a base map (reference map)



```{r Type your answer here}

```



Head back to mentimeter to answer some recap questions!!

*Code = 89 32 01 5*












